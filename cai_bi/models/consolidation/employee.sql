{{ 
    config(
        materialized="table",
        schema="consolidation"
    )
}}
with
    portal_employee as (select * from {{ source('portal', 'users') }} where _fivetran_deleted = false),

portal as (
SELECT 
    AZURE_ID,
    BASETEAM_ID,
    SALESFORCE_CONTACT_ID,
    CONTINENT_ID,
    CONTRACTOR_COMPANY_ID,
    COUNTRY_ID,
    DEPARTMENT_ID,
    DOL_STATUS_ID,
    EMPLOYEE_TYPE_ID,
    ENTITY_ID,
    ETHNIC_BACKGROUND_ID,
    GENDER_ID,
    INTACCT_CONTACT_RECORD_NO,
    INTACCT_DEPARTMENT_RECORD_NO,
    INTACCT_LOCATION_RECORD_NO,
    INTACCT_EMPLOYEE_RECORD_NO,
    INTACCT_OVERRIDE_ENTITY_ID,
    LABOR_CATEGORY_ID,
    LOCATION_ID,
    LOCATION_ID_INTACCT,
    LOCATION_ID_UKG,
    PAY_TYPE_ID,
    PAYROLL_COMPANY_ID,
    POSITION_FAMILY_ID,
    POSITION_ID,
    PRACTICE_ID,
    REGION_ID,
    SALESFORCE_SANDBOX_CONTACT_ID,
    SALESFORCE_SANDBOX_USER_ID,
    SALESFORCE_USER_ID,
    STATE_ID,
    SUPERVISOR_ID,
    ID,
    TERMINATION_TYPE_ID,
    TRACKER_RECORD_ID,
    UKG_ID,
    UKG_OVERRIDE_PAYROLL_COMPANY_ID,
    UKG_PERSON_ID,
    ADDRESS_CITY,
    ADDRESS_COUNTRY,
    ADDRESS_POSTAL_CODE,
    ADDRESS_STATE,
    ADDRESS_STREET,
    IS_MST,
    IS_PM_QUALIFIED,
    CURRENCY_ID,
    DISPLAY_NAME,
    DISPLAY_NAME_LF,
    END_DATE,
    START_DATE,
    LAST_HIRE_DATE,
    EMAIL_ADDRESS_PERSONAL,
    EMAIL_ADDRESS_WORK,
    FIRST_NAME,
    FIRST_NAME_DISPLAY,
    PHONE_NUMBER_PERSONAL
FROM portal_employee
)
select * from portal